unit uCriteriaItemTests;

interface

uses TestFramework, uCriteria, System.Rtti, System.StrUtils, System.SysUtils;

type
  TCriteriaItemTests = class(TTestCase)
  private
    MJDCriteriaItem: TMJDCriteriaItem;
  protected
    procedure SetUp; override;
    procedure TearDown; override;
  published
    procedure Cria_Criterio_Pesquisa_And_Campo_Igual_String;
  end;

implementation

procedure TCriteriaItemTests.SetUp;
begin
  MJDCriteriaItem := TMJDCriteriaItem.Create;
end;

procedure TCriteriaItemTests.TearDown;
begin
  MJDCriteriaItem.Free;
end;

procedure TCriteriaItemTests.Cria_Criterio_Pesquisa_And_Campo_Igual_String;
var Criteria: IMJDCriteria;
const
  VALOR_ESPERADO = 'AND(campo1 = ''1'')';
begin
  MJDCriteriaItem.Clear;
  MJDCriteriaItem.Attribute := 'campo1';
  MJDCriteriaItem.CompareOperator := coEqual;
  MJDCriteriaItem.Value := TValue.FromVariant(QuotedStr('1'));
  MJDCriteriaItem.LogicRelation := lrAnd;

  Criteria := NewCriteria(MJDCriteriaItem);

  CheckEqualsString(VALOR_ESPERADO, Criteria.ToString());
end;

initialization
  TestFramework.RegisterTest(TCriteriaItemTests.Suite);

end.
